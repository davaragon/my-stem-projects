<!DOCTYPE html>
<html lang="en">
<head>
  <script id="Cookiebot" src="https://consent.cookiebot.com/uc.js" data-cbid="0a9e2c4e-c6d5-4b71-9e14-b4fdc20c48b8" data-blockingmode="auto" type="text/javascript"></script>
  <script src="/js/ga-init.js"></script>
  
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>OpenFlexure Microscope – Brownian Motion Project</title>
  <meta name="description" content="A student-built OpenFlexure microscope project with Brownian motion experiment, bead tracking, and results." />

  <!-- Tailwind CSS (config must load BEFORE the Tailwind CDN script) -->
  <script src="./js/tailwind-config.js"></script>
  <script src="https://cdn.tailwindcss.com"></script>

  <!-- Favicon (optional) -->
  <link rel="icon" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Ccircle cx='50' cy='50' r='48' fill='%230ea5e9'/%3E%3Ccircle cx='50' cy='50' r='28' fill='white'/%3E%3Ccircle cx='50' cy='50' r='12' fill='%230ea5e9'/%3E%3C/svg%3E" />

  <!-- Prism for syntax highlighting -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/themes/prism.min.css" />
  <script defer src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/prism.min.js"></script>
  <script defer src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-python.min.js"></script>

  <!-- Chart.js for plotting results -->
  <script defer src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>

  <style>
    /* Smooth scroll */
    html { scroll-behavior: smooth; }
    /* Fancy underline for links */
    .link-underline { background-image: linear-gradient(currentColor, currentColor); background-size: 0% 2px; background-position: 0 100%; background-repeat: no-repeat; transition: background-size 200ms ease; }
    .link-underline:hover { background-size: 100% 2px; }
    /* Code block styling tweaks */
    pre[class*="language-"] { border-radius: 0.75rem; padding: 1rem; }
  </style>
  
</head>
<body class="bg-white text-slate-900 dark:bg-slate-950 dark:text-slate-100">
  <!-- ===== NAVBAR ===== -->
  <header class="sticky top-0 z-50 backdrop-blur supports-[backdrop-filter]:bg-white/60 dark:supports-[backdrop-filter]:bg-slate-950/60 border-b border-slate-200/70 dark:border-slate-800">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
      <div class="flex h-16 items-center justify-between">
        <a href="#top" class="flex items-center gap-2 font-semibold text-slate-900 dark:text-white">
          <span class="inline-grid place-items-center w-8 h-8 rounded-full bg-sky-500 text-white text-sm font-bold">µ</span>
          <span>With 3D‑Printed Microscope</span>
        </a>
        <nav class="hidden md:flex items-center gap-6 text-sm">
          <a class="hover:text-sky-600 link-underline" href="#overview">Overview</a>
          <a class="hover:text-sky-600 link-underline" href="#build">Build</a>
          <a class="hover:text-sky-600 link-underline" href="#experiment">Experiment</a>
          <a class="hover:text-sky-600 link-underline" href="#results">Results</a>
          <a class="hover:text-sky-600 link-underline" href="#gallery">Gallery</a>
        </nav>
        <div class="flex items-center gap-2">
          <button id="themeToggle" aria-label="Toggle dark mode" class="rounded-xl border border-slate-200 dark:border-slate-800 p-2 hover:bg-slate-100 dark:hover:bg-slate-900">
            <svg id="sun" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="h-5 w-5 hidden"><path d="M12 18a6 6 0 100-12 6 6 0 000 12z"/><path fill-rule="evenodd" d="M12 2a1 1 0 011 1v2a1 1 0 11-2 0V3a1 1 0 011-1zm0 16a1 1 0 011 1v2a1 1 0 11-2 0v-2a1 1 0 011-1zM4 11a1 1 0 011-1H7a1 1 0 110 2H5a1 1 0 01-1-1zm12 0a1 1 0 011-1h2a1 1 0 110 2h-2a1 1 0 01-1-1zM5.636 5.636a1 1 0 011.414 0L8.464 7.05a1 1 0 11-1.414 1.415L5.636 6.05a1 1 0 010-1.414zm9.9 9.9a1 1 0 011.414 0l1.414 1.414a1 1 0 11-1.415 1.414L15.536 16.95a1 1 0 010-1.414zM4.222 17.364a1 1 0 011.415-1.414l1.414 1.414a1 1 0 01-1.415 1.414L4.222 17.364zm12.728-12.728a1 1 0 011.414 1.414L16.95 7.464A1 1 0 1115.536 6.05l1.414-1.414z" clip-rule="evenodd"/></svg>
            <svg id="moon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="h-5 w-5"><path fill-rule="evenodd" d="M9.598 2.1a1 1 0 01.227 1.034A9 9 0 1020.867 14.175a1 1 0 011.26-1.26A11 11 0 118.563 1.873 1 1 0 019.598 2.1z" clip-rule="evenodd"/></svg>
          </button>
          <button id="menuBtn" class="md:hidden rounded-xl border border-slate-200 dark:border-slate-800 p-2 hover:bg-slate-100 dark:hover:bg-slate-900" aria-expanded="false" aria-controls="mobileMenu" aria-label="Open menu">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="h-5 w-5"><path fill-rule="evenodd" d="M3.75 5.25a.75.75 0 000 1.5h16.5a.75.75 0 000-1.5H3.75zm0 6a.75.75 0 000 1.5h16.5a.75.75 0 000-1.5H3.75zm0 6a.75.75 0 000 1.5h16.5a.75.75 0 000-1.5H3.75z" clip-rule="evenodd"/></svg>
          </button>
        </div>
      </div>
      <nav id="mobileMenu" class="md:hidden hidden pb-4">
        <a class="block py-2 hover:text-sky-600" href="#overview">Overview</a>
        <a class="block py-2 hover:text-sky-600" href="#build">Build</a>
        <a class="block py-2 hover:text-sky-600" href="#experiment">Experiment</a>
        <a class="block py-2 hover:text-sky-600" href="#results">Results</a>
        <a class="block py-2 hover:text-sky-600" href="#gallery">Gallery</a>
      </nav>
    </div>
  </header>

  <!-- ===== HERO ===== -->
  <section id="top" class="relative overflow-hidden">
    <div class="absolute inset-0 bg-gradient-to-br from-sky-500/10 via-purple-500/10 to-fuchsia-500/10 pointer-events-none"></div>
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-16 sm:py-24">
      <div class="grid lg:grid-cols-2 gap-10 items-center">
        <div>
          <h1 class="text-4xl sm:text-5xl font-extrabold tracking-tight">Brownian Motion with <span class="text-sky-600">3D-Printed Microscope</span></h1>
          <p class="mt-4 text-lg text-slate-600 dark:text-slate-300">I built an openflexure microscope with printed parts, assembled the optics, 
            and used Python to track Brownian motion of microbeads. This page documents the build, the experiment, and my results.</p>
     
          <div class="mt-6 flex flex-wrap gap-3">
            <span class="px-3 py-1 rounded-full bg-sky-100 text-sky-700 dark:bg-sky-900/40 dark:text-sky-300 text-sm">3D Printing</span>
            <span class="px-3 py-1 rounded-full bg-purple-100 text-purple-700 dark:bg-purple-900/40 dark:text-purple-300 text-sm">Microscopy</span>
            <span class="px-3 py-1 rounded-full bg-emerald-100 text-emerald-700 dark:bg-emerald-900/40 dark:text-emerald-300 text-sm">Python</span>
          </div>

          <div class="mt-8 flex gap-3">
            <a href="#experiment" class="inline-flex items-center gap-2 rounded-xl bg-sky-600 text-white px-4 py-2 shadow hover:bg-sky-700 transition">See Experiment
              <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M5 12h14"/><path d="M12 5l7 7-7 7"/></svg>
            </a>
            <a href="#results" class="inline-flex items-center gap-2 rounded-xl border border-slate-200 dark:border-slate-800 px-4 py-2 hover:bg-slate-100 dark:hover:bg-slate-900 transition">Jump to Results</a>
          </div>
        </div>
        <div class="relative">
          <div class="aspect-[4/3] w-full rounded-2xl bg-slate-200 dark:bg-slate-800 overflow-hidden shadow-xl">
            <!-- Replace the placeholder with hero image/video still -->
            <img src="./images/brownian_motion_microscope.gif" alt="Microscope close up" class="w-full h-full object-cover"/>
          </div>
          <p class="mt-2 text-xs text-slate-500">Placeholder image — swap with a FINAL hero.</p>
        </div>
      </div>
    </div>
  </section>

  <!-- ===== OVERVIEW ===== -->
  <section id="overview" class="py-16 sm:py-24">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
      <div class="grid lg:grid-cols-3 gap-8">
        <div class="lg:col-span-2">
          <h2 class="text-3xl font-bold">Project Overview</h2>
          <p class="mt-4 text-slate-600 dark:text-slate-300">OpenFlexure is an open-source, 3D‑printed microscope with a flexure-based stage. I printed the components, sourced optics, and assembled the mechanism at home. The goal: capture videos of <em>Brownian motion</em> of polystyrene beads in water and analyze the diffusion using Python.</p>
          <div class="mt-6 grid sm:grid-cols-2 gap-6">
            <div class="p-6 rounded-2xl border border-slate-200 dark:border-slate-800">
              <h3 class="font-semibold">What I built</h3>
              <ul class="mt-3 list-disc list-inside text-slate-600 dark:text-slate-300 space-y-1">
                <li>3D‑printed frame, flexure stage, and optics mounts</li>
                <li>Raspberry Pi camera module + LED illumination</li>
                <li>Manual focus with fine Z motion</li>
              </ul>
            </div>
            <div class="p-6 rounded-2xl border border-slate-200 dark:border-slate-800">
              <h3 class="font-semibold">What I measured</h3>
              <ul class="mt-3 list-disc list-inside text-slate-600 dark:text-slate-300 space-y-1">
                <li>Tracked bead positions (x, y) over time</li>
                <li>Computed Mean Squared Displacement (MSD)</li>
                <li>Estimated diffusion coefficient <code>D</code></li>
              </ul>
            </div>
          </div>
        </div>
        <aside class="lg:col-span-1">
          <div class="p-6 rounded-2xl border border-slate-200 dark:border-slate-800">
            <h3 class="font-semibold">Bill of Materials (BOM)</h3>
            <ul class="mt-3 space-y-2 text-sm">
              <li class="flex items-start gap-2"><span class="mt-1 h-2 w-2 rounded-full bg-sky-500"></span> 3D‑printed parts (PLA/PETG)</li>
              <li class="flex items-start gap-2"><span class="mt-1 h-2 w-2 rounded-full bg-sky-500"></span> M3 screws, heat‑set inserts</li>
              <li class="flex items-start gap-2"><span class="mt-1 h-2 w-2 rounded-full bg-sky-500"></span> Objective lens (e.g., 10×) & tube lens</li>
              <li class="flex items-start gap-2"><span class="mt-1 h-2 w-2 rounded-full bg-sky-500"></span> Raspberry Pi + Camera (or USB cam)</li>
              <li class="flex items-start gap-2"><span class="mt-1 h-2 w-2 rounded-full bg-sky-500"></span> White LED + diffuser</li>
              <li class="flex items-start gap-2"><span class="mt-1 h-2 w-2 rounded-full bg-sky-500"></span> Polystyrene beads (1–5 µm)</li>
              <li class="flex items-start gap-2"><span class="mt-1 h-2 w-2 rounded-full bg-sky-500"></span> Microscope slides & coverslips</li>
            </ul>
          </div>
        </aside>
      </div>
    </div>
  </section>

  <!-- ===== BUILD ===== -->
  <section id="build" class="py-16 sm:py-24 bg-slate-50 dark:bg-slate-900/30">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
      <div class="max-w-3xl">
        <h2 class="text-3xl font-bold">Build Notes</h2>
        <p class="mt-4 text-slate-600 dark:text-slate-300">Here’s how I assembled the microscope. Swap the text with your own steps, tips, and photos.</p>
      </div>
      <ol class="mt-8 grid lg:grid-cols-3 gap-6 counter-reset">
        <li class="p-6 rounded-2xl border border-slate-200 dark:border-slate-800 bg-white/60 dark:bg-slate-950/30">
          <div class="flex items-center justify-between">
            <h3 class="font-semibold">Print & Prep</h3>
            <span class="text-xs px-2 py-1 rounded-full bg-slate-100 dark:bg-slate-800">Step 1</span>
          </div>
          <p class="mt-3 text-sm text-slate-600 dark:text-slate-300">Printed parts at 0.2 mm layer height. Cleaned supports and heat‑set inserts.</p>
        </li>
        <li class="p-6 rounded-2xl border border-slate-200 dark:border-slate-800 bg-white/60 dark:bg-slate-950/30">
          <div class="flex items-center justify-between">
            <h3 class="font-semibold">Stage & Optics</h3>
            <span class="text-xs px-2 py-1 rounded-full bg-slate-100 dark:bg-slate-800">Step 2</span>
          </div>
          <p class="mt-3 text-sm text-slate-600 dark:text-slate-300">Assembled flexure stage, mounted objective, aligned tube lens and camera.</p>
        </li>
        <li class="p-6 rounded-2xl border border-slate-200 dark:border-slate-800 bg-white/60 dark:bg-slate-950/30">
          <div class="flex items-center justify-between">
            <h3 class="font-semibold">Illumination</h3>
            <span class="text-xs px-2 py-1 rounded-full bg-slate-100 dark:bg-slate-800">Step 3</span>
          </div>
          <p class="mt-3 text-sm text-slate-600 dark:text-slate-300">Installed LED and diffuser for bright‑field imaging.</p>
        </li>
      </ol>
    </div>
  </section>

  <!-- ===== EXPERIMENT ===== -->
  <section id="experiment" class="py-16 sm:py-24">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
      <div class="grid lg:grid-cols-2 gap-10 items-start">
        <div>
          <h2 class="text-3xl font-bold">Brownian Motion Experiment</h2>
          <p class="mt-4 text-slate-600 dark:text-slate-300">I prepared a dilute suspension of polystyrene beads in water and recorded a video through the microscope. The bead trajectories were tracked in Python. Assuming 2D diffusion, the MSD relates to time lag <code>Δt</code> by <code>MSD(Δt) = 4 D Δt</code>, where <code>D</code> is the diffusion coefficient.</p>

          <div class="mt-6 space-y-4">
            <details class="group rounded-xl border border-slate-200 dark:border-slate-800 p-4 bg-white/60 dark:bg-slate-950/30">
              <summary class="cursor-pointer font-semibold flex items-center justify-between">Python Tracking Snippet <span class="text-xs text-slate-500">(using trackpy)</span></summary>
              <pre class="mt-3 language-python"><code>import pandas as pd
import trackpy as tp
import pims

# Load frames (e.g., mp4 converted to image sequence or using pims.Video)
frames = pims.Video('beads.mp4')

# Locate bright beads (~3 px radius)
f = tp.batch(frames, diameter=9, minmass=500)

# Link features into trajectories (search range in pixels)
linked = tp.link_df(f, search_range=10)

# Filter short trajectories
traj = tp.filter_stubs(linked, threshold=30)

# Compute mean-squared displacement (MSD)
msd = tp.emsd(traj, mpp=0.1, fps=30)  # mpp: microns per pixel, fps: frames per second
print(msd.head())

# Estimate diffusion coefficient from linear fit of MSD vs lag time</code></pre>
              <p class="text-xs text-slate-500 mt-3">Swap <code>mpp</code> with your calibration (µm/pixel) and <code>fps</code> with your frame rate.</p>
            </details>

            <details class="group rounded-xl border border-slate-200 dark:border-slate-800 p-4 bg-white/60 dark:bg-slate-950/30">
              <summary class="cursor-pointer font-semibold">Recording Setup Tips</summary>
              <ul class="mt-3 list-disc list-inside text-slate-600 dark:text-slate-300 space-y-1 text-sm">
                <li>Use a thin sample and avoid convection—wait 1–2 minutes after sealing.</li>
                <li>Record at a constant frame rate (e.g., 30 fps) and stable lighting.</li>
                <li>Focus on a plane with sparse, non‑overlapping beads.</li>
              </ul>
            </details>
          </div>
        </div>

        <div>
          <div class="aspect-video w-full rounded-2xl bg-slate-200 dark:bg-slate-800 overflow-hidden shadow-xl">
            <!-- My experiment video -->
            <video controls class="w-full h-full object-cover">
              <source src="" type="video/mp4" />
            </video>
          </div>
          <p class="mt-2 text-xs text-slate-500">Placeholder for Brownian motion video (mp4).</p>
        </div>
      </div>
    </div>
  </section>

  <!-- ===== RESULTS / INTERACTIVE CHART ===== -->
  <section id="results" class="py-16 sm:py-24 bg-slate-50 dark:bg-slate-900/30">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
      <div class="max-w-3xl">
        <h2 class="text-3xl font-bold">Results</h2>
        <p class="mt-4 text-slate-600 dark:text-slate-300">Upload a CSV of tracked bead centers to plot trajectories and compute MSD. Expected columns: <code>time_s,x_um,y_um</code>. Sampling should be uniform in time.</p>
      </div>

      <!-- Controls -->
      <div class="mt-6 grid lg:grid-cols-3 gap-6">
        <div class="lg:col-span-1 p-6 rounded-2xl border border-slate-200 dark:border-slate-800 bg-white/60 dark:bg-slate-950/30">
          <h3 class="font-semibold">Data</h3>
          <input id="csvInput" type="file" accept=".csv" class="mt-3 block w-full text-sm file:mr-4 file:py-2 file:px-3 file:rounded-lg file:border-0 file:text-sm file:font-medium file:bg-sky-600 file:text-white hover:file:bg-sky-700" />
          <button id="demoBtn" class="mt-3 w-full rounded-lg border border-slate-200 dark:border-slate-700 px-3 py-2 text-sm hover:bg-slate-100 dark:hover:bg-slate-900">Load demo data</button>
          <div class="mt-4 grid grid-cols-2 gap-3 text-sm">
            <label class="block">mpp (µm/px)
              <input id="mpp" type="number" step="any" value="0.10" class="mt-1 w-full rounded-lg border border-slate-300 bg-white/80 dark:bg-slate-900 dark:border-slate-700 px-3 py-2" />
            </label>
            <label class="block">fps
              <input id="fps" type="number" step="any" value="30" class="mt-1 w-full rounded-lg border border-slate-300 bg-white/80 dark:bg-slate-900 dark:border-slate-700 px-3 py-2" />
            </label>
          </div>
          <button id="analyzeBtn" class="mt-4 w-full rounded-xl bg-sky-600 text-white px-4 py-2 shadow hover:bg-sky-700 transition">Analyze</button>
          <p id="status" class="mt-3 text-xs text-slate-500"></p>
          <div class="mt-4 text-sm">
            <p><span class="font-medium">Estimated D:</span> <span id="D">—</span> µm²/s</p>
          </div>
        </div>

        <div class="lg:col-span-2 space-y-6">
          <div class="p-6 rounded-2xl border ... bg-white/60 dark:bg-slate-950/30" style="height:320px">
            <h3 class="font-semibold">Trajectory (x vs y)</h3>
            <canvas id="trajChart" class="h-full w-full"></canvas>
            </div>

            <div class="p-6 rounded-2xl border ... bg-white/60 dark:bg-slate-950/30" style="height:320px">
            <h3 class="font-semibold">MSD vs Δt</h3>
            <canvas id="msdChart" class="h-full w-full"></canvas>
            </div>
        </div>
      </div>
      <p class="mt-4 text-xs text-slate-500">Note: MSD is computed across lags assuming uniform time steps; only initial lags are used for the linear fit.</p>
    </div>
  </section>

  <!-- ===== GALLERY ===== -->
  <section id="gallery" class="py-16 sm:py-24">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
      <h2 class="text-3xl font-bold">Build Gallery</h2>
      <p class="mt-4 text-slate-600 dark:text-slate-300">A few shots from the build and setup.</p>
      <div class="mt-6 grid sm:grid-cols-2 lg:grid-cols-3 gap-4">
        <!-- Replace with final images -->
        <img class="aspect-[4/3] w-full object-cover rounded-2xl border border-slate-200 dark:border-slate-800" src="./images/openflexure_microscope.jpg" alt="Microscope" />
        <img class="aspect-[4/3] w-full object-cover rounded-2xl border border-slate-200 dark:border-slate-800" src="./images/Components.jpg" alt="Microscope components" />
        <img class="aspect-[4/3] w-full object-cover rounded-2xl border border-slate-200 dark:border-slate-800" src="./images/3d_printer.jpg" alt="3D printer" />
      </div>
    </div>
  </section>

  <!-- ===== FOOTER ===== -->
  <footer class="py-10 border-t border-slate-200 dark:border-slate-800">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
      <div class="flex flex-col sm:flex-row justify-between gap-4 text-sm text-slate-500">
        <p>© <span id="year"></span> Yaan A. — Student STEM Portfolio</p>
        <p>Built with HTML, TailwindCSS, Prism, and Chart.js</p>
      </div>
    </div>
  </footer>

  <!-- Your app scripts -->
  <script defer src="./js/utils.js"></script>
  <script defer src="./js/charts.js"></script>
  <script defer src="./js/data.js"></script>
  <script defer src="./js/ui.js"></script>
  <script defer src="./js/app.js"></script>
</body>
</html>
